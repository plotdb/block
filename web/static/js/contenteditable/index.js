// Generated by LiveScript 1.3.1
/*
  fix contenteditable="false" + input/table/etc backspace issue in contenteditable.
*/
document.addEventListener('keydown', function(evt){
  var target, sel, range, prev;
  target = evt.target;
  if (!(window.getSelection && evt.which === 8)) {
    return;
  }
  sel = window.getSelection();
  if (!(sel.isCollapsed && sel.rangeCount)) {
    return;
  }
  range = sel.getRangeAt(sel.rangeCount - 1);
  if (range.commonAncestorContainer.nodeType === 3 && range.startOffset > 0) {
    return;
  }
  range = document.createRange();
  if (sel.anchorNode !== target) {
    range.selectNodeContents(target);
    range.setEndBefore(sel.anchorNode);
  } else if (sel.anchorOffset > 0) {
    range.setEnd(target, sel.anchorOffset);
  } else {
    return;
  }
  range.setStart(target, range.endOffset - 1);
  prev = range.cloneContents().lastChild;
  if (prev && prev.contentEditable === 'false') {
    range.deleteContents();
    return event.preventDefault();
  }
});